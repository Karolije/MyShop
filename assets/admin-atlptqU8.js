import{r as a,j as e,s as l,R as m,a as w}from"./supabaseClient-Czq_rhEw.js";const p=["nowe","w realizacji","zrealizowane","wysłane","zwrot","odebrane"],f=()=>{const[n,d]=a.useState([]),[o,h]=a.useState(!0),[c,u]=a.useState(null);a.useEffect(()=>{(async()=>{try{const{data:t,error:s}=await l.from("orders").select("*").order("createdAt",{ascending:!1});if(s)throw s;d(t??[])}catch(t){console.error("Błąd pobierania zamówień:",t),u(t.message)}finally{h(!1)}})()},[]);const j=async(r,t)=>{try{const{error:s}=await l.from("orders").update({status:t}).eq("id",r);if(s)throw s;d(x=>x.map(i=>i.id===r?{...i,status:t}:i))}catch(s){console.error("Nie udało się zaktualizować statusu:",s),alert("Nie udało się zaktualizować statusu")}};return o?e.jsx("p",{children:"Ładowanie zamówień..."}):c?e.jsxs("p",{children:["Błąd: ",c]}):n.length===0?e.jsx("p",{children:"Brak zamówień"}):e.jsxs("div",{children:[e.jsx("h1",{children:"Historia zamówień"}),e.jsxs("table",{style:{borderCollapse:"collapse",width:"100%"},children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"ID"}),e.jsx("th",{children:"Użytkownik"}),e.jsx("th",{children:"Produkty"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Data"}),e.jsx("th",{children:"Zmiana statusu"})]})}),e.jsx("tbody",{children:n.map(r=>e.jsxs("tr",{children:[e.jsx("td",{children:r.id}),e.jsx("td",{children:r.userId}),e.jsx("td",{children:e.jsx("ul",{children:Array.isArray(r.items)&&r.items.length>0?r.items.map(({productId:t,quantity:s})=>e.jsxs("li",{children:["Produkt ",t," — ilość: ",s]},t)):e.jsx("li",{children:"Brak produktów w zamówieniu"})})}),e.jsx("td",{children:r.status}),e.jsx("td",{children:new Date(r.createdAt).toLocaleString()}),e.jsx("td",{children:e.jsx("select",{value:r.status,onChange:t=>j(r.id,t.target.value),children:p.map(t=>e.jsx("option",{value:t,children:t},t))})})]},r.id))})]})]})};m.createRoot(document.getElementById("root")).render(e.jsx(w.StrictMode,{children:e.jsx(f,{})}));
